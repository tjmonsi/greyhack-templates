import_code("/home/tjmonsi/scripts/lib/loadcrypto.src")
import_code("/home/tjmonsi/scripts/lib/loadmetaxploit.src")
import_code("/home/tjmonsi/scripts/lib/parseparams.src")
import_code("/home/tjmonsi/scripts/lib/printcolor.src")
import_code("/home/tjmonsi/scripts/lib/exploitlib.src")
import_code("/home/tjmonsi/scripts/lib/decipherpass.src")
import_code("/home/tjmonsi/scripts/lib/getetcpass.src")
import_code("/home/tjmonsi/scripts/lib/moverflow.src")

config = parseparams(program_path.split("/")[-1], ["libPath", "memory", "exploit", "string"], 1)

libPath = config.libPath
memory = config.memory
exploit = config.exploit
string = null

if config.hasIndex("string") then
	string = config.string	
end if

exploitlib(libPath, memory, exploit, string)
