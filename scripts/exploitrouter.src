import_code("/home/tjmonsi/scripts/lib/loadcrypto.src")
import_code("/home/tjmonsi/scripts/lib/loadmetaxploit.src")
import_code("/home/tjmonsi/scripts/lib/parseparams.src")
import_code("/home/tjmonsi/scripts/lib/printcolor.src")
import_code("/home/tjmonsi/scripts/lib/exploitrouter.src")
import_code("/home/tjmonsi/scripts/lib/decipherpass.src")
import_code("/home/tjmonsi/scripts/lib/getetcpass.src")
import_code("/home/tjmonsi/scripts/lib/moverflow.src")
import_code("/home/tjmonsi/scripts/lib/getfile.src")

config = parseparams(program_path.split("/")[-1], ["ip", "port", "memory", "exploit", "string", "pathName"], 2)

address = config.ip
port = config.port
memory = config.memory
exploit = config.exploit
string = null
pathName = null

if config.hasIndex("string") then
	string = config.string	
end if

if config.hasIndex("pathName") then
	pathName = config.pathName	
end if

if port == 0 then
	port = null
end if

if port then
	exploitrouter(address, port.to_int, memory, exploit, string, pathName)
else
	exploitrouter(address, null, memory, exploit, string, pathName)
end if
